select 
    d.dept_name,
    count(p.emp_id) as employee_count,
    sum(p.amount) as total_payroll
from 
    payroll as p
join 
    employees as e on e.emp_id = p.emp_id
join 
    departments as d on e.dept_id = d.dept_id
group by 
    d.dept_id
order by    
    total_payroll desc,
    d.dept_name asc;